#!/usr/bin/env node

/**
 * Module dependencies.
 */

const config = require('../config')
const logger = require('../utils/logger')

switch (config.clusterMode) {
  case true: {
    const master = require('../app/master');
    (async function () {
      await master.init(config, logger)
      await master.start()
    }())
    break
  }
  case false: {
    const server = require('../app/server');
    (async function () {
      process.on('SIGTERM', server.stop('SIGTERM'))
      process.on('SIGINT', server.stop('SIGINT'))
      await server.init(config, logger)
      await server.start()
    }())
    break
  }
  default: {
    throw Error('Error env CLUSTER_MODE')
  }
}
